require(MTS)
library(urca)
library(lattice)
library(foreign)
library(MASS)
library(car)
require(stats)
require(stats4)
library(KernSmooth)
library(fastICA)
library(cluster)
library(leaps)
library(mgcv)
library(rpart)
library(pan)
library(mgcv)
library(DAAG)
library(TTR)
library(tis)
require("datasets")
require(graphics)
library(forecast)
#install.packages("astsa")
#require(astsa)
library(xtable)
# New libraries added:
library(stats)
library(TSA)
library(timeSeries)
library(fUnitRoots)
library(fBasics)
library(tseries)
library(timsac)
library(TTR)
library(fpp)
library(strucchange)
#library(MSBVAR)
library(vars)
library(lmtest)
library(dlnm)
da=read.table("d-bhp0206.txt",header=T)
da1=read.table("d-vale0206.txt",header=T)
bhp=log(da$adjclose)
vale=log(da1$adjclose)
bhp1=ts(bhp,frequency=252,start=c(2002,127))
vale1=ts(vale,frequency=252,start=c(2002,127))
window()
plot(bhp1, type ='l', col = "blue",ylim=c(0.45,3.7),ylab="Stock Price ($)", main= "Pairs Trading Example")
lines(vale1, type ='l', col = "red")
legend(2003, 3.5, c("BHP","Vale"), fill=c("blue","red"),cex =1.2,bty='n')
windows()
plot(bhp1, type ='l', col = "blue",ylim=c(0.45,3.7),ylab="Stock Price ($)", main= "Pairs Trading Example")
lines(vale1, type ='l', col = "red")
legend(2003, 3.5, c("BHP","Vale"), fill=c("blue","red"),cex =1.2,bty='n')
reg=lm(bhp~vale)
summary(mreg)
mreg=lm(bhp~vale)
summary(mreg)
x=cbind(bhp,vale)
m1=ar(x)
m1$order
m2=ca.jo(x,K=2)
summary(m2)
m3=ca.jo(x,K=2,type=c("trace"))
summary(m3)
help("ca.jo")
wt=bhp1-0.718*vale1
windows()
plot(wt,type='l',ylab="wt = BHP - 0.72Vale",main = "Co-integration Relation")
abline(h=c(1.82),col="red")
legend(2003, 1.95,c("wt","E[wt] = 1.82"),fill=c("black","red"))
summary(wt)
windows()
plot(forecast(wt))
windows()
tsdiag(ets(wt))
ets(wt)
help("tsdiag")
windows()
plot(forecast(wt))
windows()
tsdisplay(ets(wt))
ets(wt)
plot(ets(wt))
help(ets\)
help(ets)
windows()
plot(forecast(wt))
tsdiag(wt)
tsdisplay(wt)
help(getSymbols)
getSymbols(c("FTSE", "SPX"))
library(quantmod)
setwd("/Users/Xiang/OneDrive/Desktop/Econ-144/Week 9")
getSymbols(c("FTSE", "SPX"))
rm(list = ls(all=T))
library(quantmod)
setwd("/Users/Xiang/OneDrive/Desktop/Econ-144/Week 9")
getSymbols(c("FTSE", "SPX"))
install.packages("qrmdata")
rm(list = ls(all=T))
library(quantmod)
library(qrmdata)
setwd("/Users/Xiang/OneDrive/Desktop/Econ-144/Week 9")
data("SP500")
data("DJ")
data("NASDAQ")
data("FTSE")
data("SMI")
data("EURSTOXX")
data("CAC")
data("DAX")
data("CSI")
data("HSI")
data("SSEC")
data("NIKKEI")
plot(CAC)
View(CAC)
View(CAC)
data("DJ")
plot(DJ)
windows()
par(mfrow=c(2,2))
plot(CAC)
plot(DJ)
plot(NASDAQ)
plot(CSI)
windows()
par(mfrow=c(2,2))
plot(HSI)
plot(FTSE)
plot(SMI)
plot(EURSTOXX)
windows()
par(mfrow=c(2,2))
plot(DAX)
plot(SSEC)
plot(NIKKEI)
reg=lm(DJ~NASDAQ)
summary(mreg)
View(DJ)
View(DJ)
View(NASDAQ)
View(NASDAQ)
DJ(152:)
DJ[152:]
DJ[152]
DJ[153]
DJ[160]
DJ[170]
DJ[170:length(DJ)]
reg=lm(DJ[169:length(DJ)]~NASDAQ)
length(DJ[169:length(DJ)])
length(NASDAQ)
reg=lm(DJ[170:length(DJ)]~NASDAQ)
summary(mreg)
y(reg)
summary(reg)
install.packages("aTSA")
library(aTSA)
adf.test(reg$residuals)
reg$residuals
residuals(reg)
typeof(reg$residuals)
adf.test(reg$residuals)
k = reg$residuals
View(k)
View(k)
as.ts(k)
k = as.ts(k)
adf.test(k)
View(k)
plot(k)
